<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaspa Node Dashboard</title>
    <link rel="icon" type="image/png" href="kaspa-glow.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="custom.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'kaspa-teal': '#0d9488',
                        'kaspa-zinc': {
                            800: '#27272a',
                            900: '#18181b',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-black text-gray-200 min-h-screen">
    <div class="flex min-h-screen w-full flex-col">
        <main class="flex-1 p-2 sm:p-4 md:p-8">
            <div class="grid gap-4 sm:gap-6 max-w-7xl mx-auto px-2 sm:px-4">
                
                <!-- Header Card -->
                <div class="bg-zinc-900/70 border border-zinc-800 rounded-lg p-4 sm:p-6">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                        <div class="flex items-center gap-4 min-w-0 flex-1">
                            <img src="kaspa-glow.png" alt="Kaspa Logo" width="60" height="60" class="flex-shrink-0" />
                            <div class="min-w-0 flex-1">
                                <h1 class="text-xl font-bold tracking-tight text-gray-50">Kaspa Node</h1>
                                <p class="text-sm text-zinc-400" id="version">Loading...</p>
                                <button class="font-mono text-xs text-zinc-500 cursor-pointer truncate text-left" id="p2pId" title="Click to copy P2P ID" aria-label="Copy P2P ID to clipboard">
                                    P2P ID: Loading...
                                </button>
                                <div class="flex items-center gap-2 mt-2">
                                    <div class="flex items-center gap-1">
                                        <div id="connectionIndicator" class="w-2 h-2 rounded-full bg-gray-500 animate-pulse" title="Connection status"></div>
                                        <span class="text-xs text-zinc-400" id="connectionStatus">Connecting...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0 w-full sm:w-auto text-center sm:text-right">
                            <div class="flex items-center justify-center sm:justify-end gap-2 mb-1">
                                <p class="text-sm text-zinc-400">Status</p>
                                <div class="relative group">
                                    <svg class="h-4 w-4 text-zinc-500 hover:text-zinc-400 cursor-help transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-zinc-900 border border-zinc-700 rounded-lg text-xs text-zinc-300 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10 w-64 text-center">
                                        Please note that your node needs to fully synchronise with the Kaspa network before it can be used. Initial synchronisation may take at least 1-2 hours depending on your hardware and network connection.
                                    </div>
                                </div>
                            </div>
                            <p class="text-2xl font-bold text-teal-400" id="syncStatus">Loading...</p>
                            <p class="text-xs text-zinc-500" id="uptime">Loading...</p>
                        </div>
                    </div>
                </div>

                <!-- Top Stats -->
                <div class="grid gap-4 sm:gap-6 md:grid-cols-2 lg:grid-cols-3">
                    <div class="bg-zinc-900/70 border border-zinc-800 rounded-lg p-4 sm:p-6">
                        <div class="flex items-center justify-between pb-2">
                            <h3 class="text-sm font-medium text-zinc-400">Connections</h3>
                            <svg class="h-4 w-4 text-zinc-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                        </div>
                        <div class="text-2xl font-bold text-gray-50" id="connectedPeers">Loading...</div>
                        <p class="text-xs text-zinc-500" id="peerDirection">Loading...</p>
                    </div>
                    <div class="bg-zinc-900/70 border border-zinc-800 rounded-lg p-4 sm:p-6">
                        <div class="flex items-center justify-between pb-2">
                            <h3 class="text-sm font-medium text-zinc-400">Average Ping</h3>
                            <svg class="h-4 w-4 text-zinc-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                        </div>
                        <div class="text-2xl font-bold text-gray-50" id="averagePing">Loading...</div>
                        <p class="text-xs text-zinc-500" id="ibdPeers">Loading...</p>
                    </div>
                    <div class="bg-zinc-900/70 border border-zinc-800 rounded-lg p-4 sm:p-6">
                        <div class="flex items-center justify-between pb-2">
                            <h3 class="text-sm font-medium text-zinc-400">Mempool</h3>
                            <svg class="h-4 w-4 text-zinc-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                        </div>
                        <div class="text-2xl font-bold text-gray-50" id="mempoolSize">Loading...</div>
                        <p class="text-xs text-zinc-500" id="network">Loading...</p>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="grid grid-cols-1 gap-4 sm:gap-6 lg:grid-cols-3">
                    <!-- Sync Progress -->
                    <div class="lg:col-span-2 bg-zinc-900/70 border border-zinc-800 rounded-lg relative overflow-hidden">
                        <div class="absolute inset-0 grid-background"></div>
                        <div class="relative p-4 sm:p-6">
                            <div class="flex items-center gap-2 mb-6">
                                <div class="relative flex h-3 w-3">
                                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-teal-400 opacity-75"></span>
                                    <span class="relative inline-flex rounded-full h-3 w-3 bg-teal-500"></span>
                                </div>
                                <h2 class="text-lg font-semibold text-gray-50">Sync Progress</h2>
                            </div>
                            <div class="flex flex-col items-center justify-center gap-6 pt-4">
                                <div id="syncPhaseIndicator" class="flex w-full items-start justify-center px-2 sm:px-4 md:px-8">
                                    <!-- Phase indicators will be populated here -->
                                </div>
                                <div class="text-center">
                                    <p class="text-zinc-400 text-sm mb-4" id="syncDetails">Loading...</p>
                                    <h2 class="text-6xl font-bold text-gray-50 tracking-tighter mt-1" id="progressText">0%</h2>
                                    <p class="text-xs text-zinc-500">Overall Progress</p>
                                </div>
                                <div class="flex justify-between items-center" id="subPhaseContainer" style="display: none;">
                                    <span class="text-sm text-zinc-400">Sub-Phase: </span>
                                    <span class="text-sm text-gray-50" id="syncSubPhase">-</span>
                                </div>
                                <div class="flex justify-between items-center" id="peerAddressContainer" style="display: none;">
                                    <span class="text-sm text-zinc-400">Sync Peer: </span>
                                    <span class="text-sm text-gray-50" id="syncPeerAddress">-</span>
                                </div>
                                <div class="flex justify-between items-center" id="syncErrorContainer" style="display: none;">
                                    <span class="text-sm text-zinc-400">Error: </span>
                                    <span class="text-sm text-red-400" id="syncError">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Connections -->
                    <div class="bg-zinc-900/70 border border-zinc-800 rounded-lg p-4 sm:p-6">
                        <h2 class="text-lg font-semibold text-gray-50 mb-4">Connections</h2>
                        <div class="flex flex-col items-center justify-center gap-4">
                            <div id="radialProgress" class="relative flex items-center justify-center w-40 h-40">
                                <!-- Radial progress will be populated here -->
                            </div>
                            <div class="w-full space-y-2 text-sm">
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center gap-2">
                                        <span class="h-2 w-2 rounded-full bg-teal-400"></span>
                                        <span>Outbound</span>
                                    </div>
                                    <span id="outboundCount">0</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="flex items-center gap-2">
                                        <span class="h-2 w-2 rounded-full bg-purple-400"></span>
                                        <span>Inbound</span>
                                    </div>
                                    <span id="inboundCount">0</span>
                                </div>
                                <div class="flex justify-between items-center pt-2">
                                    <span class="text-zinc-400">UTXO Indexed</span>
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border border-red-500/50 bg-red-500/10 text-red-400" id="utxoIndexed">
                                        No
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Support the Network Card -->
                <div class="bg-zinc-900/70 border border-zinc-800 rounded-lg p-4 sm:p-6">
                    <div class="flex items-center gap-2 mb-4">
                        <svg class="h-5 w-5 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                        </svg>
                        <h2 class="text-lg font-semibold text-gray-50">Support the Network</h2>
                    </div>
                    <p class="text-sm text-zinc-400 mb-4">
                        The very heart of Kaspa is the public nodes. Please consider making your node public.
                    </p>
                    <div class="bg-zinc-800/50 border border-zinc-700 rounded-lg p-4">
                        <p class="text-sm text-zinc-300">
                            <span class="text-teal-400 font-medium">To support the network:</span> Forward TCP port <span class="font-mono bg-zinc-700 px-2 py-1 rounded text-teal-400">16111</span> on your firewall to your Umbrel node IP address.
                        </p>
                    </div>
                </div>

                <!-- Peer List -->
                <div class="bg-zinc-900/70 border border-zinc-800 rounded-lg p-4 sm:p-6">
                    <div class="flex items-center gap-2 mb-4">
                        <svg class="h-5 w-5 text-zinc-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.636 18.364a9 9 0 010-12.728m12.728 0a9 9 0 010 12.728m-9.9-2.829a5 5 0 010-7.07m7.072 0a5 5 0 010 7.07M13 12a1 1 0 11-2 0 1 1 0 012 0z"/>
                        </svg>
                        <h2 class="text-lg font-semibold text-gray-50">Connected Peers</h2>
                    </div>
                    <p class="text-sm text-zinc-400 mb-4">A list of peers currently connected to your node.</p>
                    <div class="overflow-x-auto custom-scrollbar">
                        <table class="w-full peer-table">
                            <thead>
                                <tr class="border-b border-zinc-800">
                                    <th class="text-left py-2 px-2 text-zinc-300 font-medium">Peer</th>
                                    <th class="text-left py-2 px-2 text-zinc-300 font-medium">Version</th>
                                    <th class="text-center py-2 px-2 text-zinc-300 font-medium">Direction</th>
                                    <th class="text-right py-2 px-2 text-zinc-300 font-medium">Ping</th>
                                    <th class="text-right py-2 px-2 text-zinc-300 font-medium">Connected</th>
                                </tr>
                            </thead>
                            <tbody id="peerList">
                                <!-- Peer rows will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="text-center text-zinc-400 text-sm">
                    Last updated: <span id="lastUpdate">Never</span>
                </div>
                <div class="text-center text-zinc-500 text-xs mt-2 space-y-1">
                    <div>Container maintained by <a href="https://hub.docker.com/u/supertypo" target="_blank" class="text-teal-400 hover:text-teal-300 transition-colors duration-200">Supertypo</a> at <a href="https://hub.docker.com/r/kaspanet/rusty-kaspad" target="_blank" class="text-teal-400 hover:text-teal-300 transition-colors duration-200">kaspanet/rusty-kaspad</a></div>
                    <div>Packaged with ❤️ by <a href="https://luke.dunshea.au/" target="_blank" class="text-teal-400 hover:text-teal-300 transition-colors duration-200">Luke Dunshea</a></div>
                </div>
            </div>
        </main>
    </div>
    
    <script src="dashboard.js"></script>
</body>
</html>